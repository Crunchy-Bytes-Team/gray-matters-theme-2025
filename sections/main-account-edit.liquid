<div class="max-w-7xl mx-auto px-6 md:px-20 py-40">
  <div class="grid grid-cols-1 md:grid-cols-[1fr_3fr] gap-8 md:gap-12 relative">
    <!-- Vertical Separator -->
    <div class="hidden md:block absolute left-[calc(25%-12px)] top-0 bottom-0 w-px bg-gray-200"></div>

    <!-- Left Column: Sidebar -->
    <div class="order-2 md:order-1">
      <!-- ORDER HISTORY -->
      <div class="mb-8">
        <a href="{{ routes.account_url }}" class="text-xl font-bold uppercase tracking-wider hover:opacity-70 transition-opacity">
          {{ 'customer.orders.title' | t }}
        </a>
      </div>

      <!-- ACCOUNT DETAILS -->
      <div class="mb-8">
        <h2 class="text-xl font-bold uppercase tracking-wider mb-4">
          {{ 'customer.account.details' | t }}
        </h2>
        <div class="space-y-2 text-sm">
          <p class="font-semibold">{{ customer.name }}</p>
          <p>{{ customer.email }}</p>
          <a href="{{ routes.account_edit_url }}" class="underline">
            Edit
          </a>
        </div>
      </div>

      <!-- MY ADDRESSES -->
      <div class="mb-8">
        <h2 class="text-xl font-bold uppercase tracking-wider mb-4">
          {{ 'customer.account.addresses' | t }}
        </h2>
        {%- if customer.default_address -%}
          <div class="mb-4 text-sm space-y-1">
            {{ customer.default_address | format_address }}
          </div>
          <div class="space-x-4">
            <a href="{{ routes.account_addresses_url }}" class="underline text-sm">
              Edit
            </a>
            <a href="{{ routes.account_addresses_url }}" class="underline text-sm">
              Add New Address
            </a>
          </div>
        {%- else -%}
          <a href="{{ routes.account_addresses_url }}" class="underline text-sm">
            Add New Address
          </a>
        {%- endif -%}
      </div>

      <!-- MY WISHLIST -->
      <div class="mb-8">
        <h2 class="text-xl font-bold uppercase tracking-wider mb-4">
          {{ 'customer.account.wishlist' | t }}
        </h2>
        <a href="{{ routes.root_url }}/pages/wishlist" class="underline text-sm">
          View/Edit Wishlist
        </a>
      </div>

      <!-- Logout -->
      <div class="mb-8">
        <a href="{{ routes.account_logout_url }}" class="underline text-sm">
          {{ 'customer.log_out' | t }}
        </a>
      </div>
    </div>

    <!-- Right Column: Edit Account Form -->
    <div class="order-1 md:order-2">
      <div class="md:pl-12">
        {%- form 'customer', class: 'account-edit-form' -%}
          {%- if form.errors -%}
            <div class="mb-6 p-4 bg-red-50 border border-red-200 text-red-700 text-sm">
              <h3 class="font-semibold mb-2">{{ 'templates.contact.form.error_heading' | t }}</h3>
              <ul class="list-disc list-inside">
                {%- for field in form.errors -%}
                  <li>
                    {%- if field == 'form' -%}
                      {{ form.errors.messages[field] }}
                    {%- else -%}
                      {{ form.errors.translated_fields[field] | capitalize }} {{ form.errors.messages[field] }}
                    {%- endif -%}
                  </li>
                {%- endfor -%}
              </ul>
            </div>
          {%- endif -%}

          {%- if form.posted_successfully? -%}
            <div class="mb-6 p-4 bg-green-50 border border-green-200 text-green-700 text-sm">
              {{ 'customer.account.details_updated' | t | default: 'Account details updated successfully.' }}
            </div>
          {%- endif -%}

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <!-- First Name -->
            <div>
              <label for="AccountEditFirstName" class="block text-sm font-medium mb-2">
                {{ 'customer.register.first_name' | t }}
              </label>
              <input
                type="text"
                name="customer[first_name]"
                id="AccountEditFirstName"
                value="{{ form.first_name | default: customer.first_name }}"
                autocomplete="given-name"
                class="w-full px-4 py-4 bg-gray-50 focus:outline-none"
              >
            </div>

            <!-- Last Name -->
            <div>
              <label for="AccountEditLastName" class="block text-sm font-medium mb-2">
                {{ 'customer.register.last_name' | t }}
              </label>
              <input
                type="text"
                name="customer[last_name]"
                id="AccountEditLastName"
                value="{{ form.last_name | default: customer.last_name }}"
                autocomplete="family-name"
                class="w-full px-4 py-4 bg-gray-50 focus:outline-none"
              >
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <!-- Email -->
            <div>
              <label for="AccountEditEmail" class="block text-sm font-medium mb-2">
                {{ 'customer.login_page.email' | t }}
              </label>
              <input
                type="email"
                name="customer[email]"
                id="AccountEditEmail"
                value="{{ form.email | default: customer.email }}"
                autocomplete="email"
                class="w-full px-4 py-4 bg-gray-50 focus:outline-none"
              >
            </div>

            <!-- Shoe Size -->
            <div>
              <label for="AccountEditShoeSize" class="block text-sm font-medium mb-2">
                Shoe Size
              </label>
              <input
                type="text"
                name="customer[note]"
                id="AccountEditShoeSize"
                value="{{ customer.note }}"
                class="w-full px-4 py-4 bg-gray-50 focus:outline-none"
                placeholder="Enter shoe size"
              >
            </div>
          </div>

          <!-- Update Password Checkbox -->
          <div class="mb-4">
            <label class="flex items-center">
              <input
                type="checkbox"
                id="UpdatePasswordCheckbox"
                name="customer[password_update]"
                class="mr-2"
                onchange="togglePasswordField(this)"
              >
              <span class="text-sm">Update Password</span>
            </label>
          </div>

          <!-- Password Field (hidden by default) -->
          <div id="PasswordField" class="mb-4 hidden">
            <label for="AccountEditPassword" class="block text-sm font-medium mb-2">
              {{ 'customer.login_page.password' | t }}
            </label>
            <input
              type="password"
              name="customer[password]"
              id="AccountEditPassword"
              autocomplete="new-password"
              class="w-full px-4 py-4 bg-gray-50 focus:outline-none"
              placeholder="{{ 'customer.login_page.password' | t }}"
            >
          </div>

          <!-- Buttons -->
          <div class="flex gap-4 mt-6">
            <button
              type="submit"
              class="bg-black text-white py-3 px-8 uppercase tracking-wider text-sm font-semibold hover:opacity-90 transition-opacity"
            >
              UPDATE
            </button>
            <a
              href="{{ routes.account_url }}"
              class="bg-white text-black border border-black py-3 px-8 uppercase tracking-wider text-sm font-semibold hover:opacity-90 transition-opacity inline-block text-center"
            >
              CANCEL
            </a>
          </div>
        {%- endform -%}
      </div>
    </div>
  </div>
</div>

<script>
  function togglePasswordField(checkbox) {
    const passwordField = document.getElementById('PasswordField');
    const passwordInput = document.getElementById('AccountEditPassword');
    
    if (checkbox.checked) {
      passwordField.classList.remove('hidden');
      passwordInput.setAttribute('required', 'required');
    } else {
      passwordField.classList.add('hidden');
      passwordInput.removeAttribute('required');
      passwordInput.value = '';
    }
  }
</script>

{% schema %}
{
  "name": "t:sections.main-account-edit.name",
  "settings": []
}
{% endschema %}

